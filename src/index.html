<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>WebGL</title>
</head>

<body style="overflow: hidden; margin: 0">
    <div style="position: absolute; bottom: 3vh; left: 50%; transform: translate(-50%, 0); background-color: white; padding: 1vh; ">
        <table style="border-spacing: 1vh">
            <tr>
                <td>
                    <label for="paused">press SPACE to pause</label>
                    <input type="checkbox" id="paused" disabled />
                </td>
                <td>
                    <span id="fps"></span>
                </td>
                <td>
                    <span id="size"></span>
                </td>
            </tr>
        </table>
    </div>

    <canvas id="glCanvas" style="width:100vw;height:100vh"></canvas>

    <script src="./index.ts"></script>

    <script id="my_vertex_shader" type="x-shader/x-vertex">
        uniform float slices;

        out vec2 texCoord;
        out float height;

        const float furHeight = 0.1;

        void main(void) {
            height = float(gl_InstanceID) * furHeight/slices;
            texCoord.x = float(gl_VertexID % 2);
            texCoord.y = float(gl_VertexID / 2);
            gl_Position.xy = texCoord - vec2(0.5);
            gl_Position.z = 1.0 - height;
            gl_Position.zw = vec2(gl_Position.z-1.0, gl_Position.z);
        }
    </script>

    <script id="my_fragment_shader" type="x-shader/x-fragment">
        precision highp float;

        in vec2 texCoord;
        in float height;

        out vec4 outColor;

        float formula(vec2 tc) {
            tc = fract(tc);
            return 1.0-9.0*distance(tc, vec2(0.5));
            float center = tc.x - 0.5;
            float dist = 1.0 - 16.0*center*center;
            return tc.y < dist ? 1.0 : 0.0;
        }

        void main(void) {
            if(height==0.0) {
                outColor = vec4(0, 0, 0, 1.0);
                return;
            }
            outColor = vec4(1, 0, 1, formula(texCoord.xy*1e1));
        }
    </script>

</body>

</html>